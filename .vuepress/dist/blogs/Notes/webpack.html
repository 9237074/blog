<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack | Cream 在努力💪</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/blog/blogs/logo.png">
    <meta name="description" content="让输出倒逼输入">
    
    <link rel="preload" href="/blog/assets/css/0.styles.15cc3f33.css" as="style"><link rel="preload" href="/blog/assets/js/app.941e80e8.js" as="script"><link rel="preload" href="/blog/assets/js/2.e09c9691.js" as="script"><link rel="preload" href="/blog/assets/js/24.d686d1ac.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.32ff04eb.js"><link rel="prefetch" href="/blog/assets/js/11.94d4215c.js"><link rel="prefetch" href="/blog/assets/js/12.5d7d5741.js"><link rel="prefetch" href="/blog/assets/js/13.3567b899.js"><link rel="prefetch" href="/blog/assets/js/14.3e2f827d.js"><link rel="prefetch" href="/blog/assets/js/15.0a278ec5.js"><link rel="prefetch" href="/blog/assets/js/16.6cd61418.js"><link rel="prefetch" href="/blog/assets/js/17.0577e7c1.js"><link rel="prefetch" href="/blog/assets/js/18.fe839c9f.js"><link rel="prefetch" href="/blog/assets/js/19.08d1a29b.js"><link rel="prefetch" href="/blog/assets/js/20.cfa72bd7.js"><link rel="prefetch" href="/blog/assets/js/21.f77fc7ac.js"><link rel="prefetch" href="/blog/assets/js/22.4c3e49ae.js"><link rel="prefetch" href="/blog/assets/js/23.0aa748fd.js"><link rel="prefetch" href="/blog/assets/js/25.ed44bb6c.js"><link rel="prefetch" href="/blog/assets/js/26.e0f12f0e.js"><link rel="prefetch" href="/blog/assets/js/3.ec48a77e.js"><link rel="prefetch" href="/blog/assets/js/4.d37862ef.js"><link rel="prefetch" href="/blog/assets/js/5.9fe721ce.js"><link rel="prefetch" href="/blog/assets/js/6.73c063ed.js"><link rel="prefetch" href="/blog/assets/js/7.9566cfda.js"><link rel="prefetch" href="/blog/assets/js/8.27e4f72d.js"><link rel="prefetch" href="/blog/assets/js/9.c8a6c43f.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.15cc3f33.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">Cream 在努力💪</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="vue" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="vue" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/blogs/FrontEnd/vue/001.html" class="nav-link">
  vue
</a></li><li class="dropdown-item"><!----> <a href="/blog/blogs/FrontEnd/react/001.html" class="nav-link">
  react
</a></li></ul></div></div><div class="nav-item"><a href="/blog/blogs/ComputerBasics/" class="nav-link">
  计算机基础
</a></div><div class="nav-item"><a href="/blog/blogs/Notes/webpack/" class="nav-link">
  webpack
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据结构与算法" class="dropdown-title"><span class="title">数据结构与算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据结构与算法" class="mobile-dropdown-title"><span class="title">数据结构与算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/blogs/Algorithm/sort/" class="nav-link">
  排序
</a></li></ul></div></div><div class="nav-item"><a href="/blog/blogs/English/" class="nav-link">
  英语
</a></div><div class="nav-item"><a href="/blog/blogs/Blog/" class="nav-link">
  杂文
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="vue" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="vue" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/blogs/FrontEnd/vue/001.html" class="nav-link">
  vue
</a></li><li class="dropdown-item"><!----> <a href="/blog/blogs/FrontEnd/react/001.html" class="nav-link">
  react
</a></li></ul></div></div><div class="nav-item"><a href="/blog/blogs/ComputerBasics/" class="nav-link">
  计算机基础
</a></div><div class="nav-item"><a href="/blog/blogs/Notes/webpack/" class="nav-link">
  webpack
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据结构与算法" class="dropdown-title"><span class="title">数据结构与算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据结构与算法" class="mobile-dropdown-title"><span class="title">数据结构与算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/blogs/Algorithm/sort/" class="nav-link">
  排序
</a></li></ul></div></div><div class="nav-item"><a href="/blog/blogs/English/" class="nav-link">
  英语
</a></div><div class="nav-item"><a href="/blog/blogs/Blog/" class="nav-link">
  杂文
</a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="webpack"><a href="#webpack" class="header-anchor">#</a> webpack</h2> <div class="language- extra-class"><pre><code>webpack webpack-cli
</code></pre></div><h2 id="webpack配置文件"><a href="#webpack配置文件" class="header-anchor">#</a> webpack配置文件</h2> <div class="language- extra-class"><pre><code>webpack.config.js
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token operator">:</span> <span class="token string">'./src/main.js'</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
        filename<span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
        path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="webpack-工作模式"><a href="#webpack-工作模式" class="header-anchor">#</a> webpack 工作模式</h3> <ol><li>watch</li> <li>production</li> <li>none</li></ol> <h3 id="模块打包"><a href="#模块打包" class="header-anchor">#</a> 模块打包</h3> <div class="language- extra-class"><pre><code>css-loader style-loader
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    module<span class="token operator">:</span><span class="token punctuation">{</span>
        rules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            use<span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
                <span class="token string">'css-loader'</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="文件资源加载器"><a href="#文件资源加载器" class="header-anchor">#</a> 文件资源加载器</h3> <div class="language- extra-class"><pre><code>file-loader
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    output<span class="token operator">:</span><span class="token punctuation">{</span>
        publicPath<span class="token operator">:</span> <span class="token string">'dist/'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    module<span class="token operator">:</span><span class="token punctuation">{</span>
        rules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.png$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            use<span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">'file-loader'</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="代码检查类"><a href="#代码检查类" class="header-anchor">#</a> 代码检查类</h3> <div class="language- extra-class"><pre><code>babel-loader
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    output<span class="token operator">:</span><span class="token punctuation">{</span>
        publicPath<span class="token operator">:</span> <span class="token string">'dist/'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    module<span class="token operator">:</span><span class="token punctuation">{</span>
        rules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            use<span class="token operator">:</span> <span class="token punctuation">[</span>
                loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
                options<span class="token operator">:</span> <span class="token punctuation">{</span>
                    presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@babel/preset-env'</span><span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="常用加载器分类"><a href="#常用加载器分类" class="header-anchor">#</a> 常用加载器分类</h3> <ol><li>编译转换类 css-loader style-loader</li> <li>文件操作类 file-loader</li> <li>代码检查类 babel-loader</li></ol> <h2 id="webpack-模块加载方式"><a href="#webpack-模块加载方式" class="header-anchor">#</a> webpack 模块加载方式</h2> <ul><li>遵循ESM标准的import声明</li> <li>遵循CommonJS标准的require函数</li> <li>遵循AMD标准的define函数和require函数</li> <li>*样式代码中的@import指令和url函数</li> <li>*HTML代码中图片标签的src属性</li></ul> <h2 id="loader的工作原理"><a href="#loader的工作原理" class="header-anchor">#</a> Loader的工作原理</h2> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">source</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'console.log(&quot;js代码&quot;)'</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="webpack常见插件"><a href="#webpack常见插件" class="header-anchor">#</a> webpack常见插件</h2> <ul><li>clean-webpack-plugin</li> <li>html-webpack-plugin</li> <li>copy-webpack-plugin</li> <li>需求 -&gt; 关键词</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> CleanWebpackPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">reuqire</span><span class="token punctuation">(</span><span class="token string">'clean-webpack-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> CopyWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'copy-webpack-plugin'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token comment">//用于清除旧文件</span>
        <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">// 用于生成index.html</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            title<span class="token operator">:</span> <span class="token string">'Webpack Plugin Sample'</span><span class="token punctuation">,</span>
            meta<span class="token operator">:</span> <span class="token punctuation">{</span>
                viewport<span class="token operator">:</span> <span class="token string">'width=device-width'</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            template<span class="token operator">:</span> <span class="token string">'./src/index.html'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">// 用于生成index.html</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            filename<span class="token operator">:</span> <span class="token string">'./src/about.html'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">//用于拷贝public文件</span>
        <span class="token keyword">new</span> <span class="token class-name">CopyWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="开发一个webpack插件"><a href="#开发一个webpack插件" class="header-anchor">#</a> 开发一个webpack插件</h2> <ul><li>钩子 Hooks 一个函数或者一个包含apply方法的对象</li> <li>通过在生命周期中的钩子中挂在函数实现拓展</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">MyPlugin</span> <span class="token punctuation">{</span>
    <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>emit<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">'MyPlugin'</span><span class="token punctuation">,</span> <span class="token parameter">compilation</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">//compilation =&gt; 可以理解为上下文</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> name <span class="token keyword">in</span> compilation<span class="token punctuation">.</span>assets<span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">'.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token keyword">const</span> contents <span class="token operator">=</span> compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token keyword">const</span> withoutComments <span class="token operator">=</span> contents<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\/\*\*+\*\/</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span>
                    compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
                         <span class="token function-variable function">source</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> withoutComments<span class="token punctuation">,</span>
                         <span class="token function-variable function">size</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> withoutComment<span class="token punctuation">.</span>length
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="增强webpack开发体验"><a href="#增强webpack开发体验" class="header-anchor">#</a> 增强webpack开发体验</h2> <ul><li>自动编译 watch工作模式
webpack --watch</li> <li>自动刷新浏览器
BrowserSync</li></ul> <h2 id="webpack-devserver"><a href="#webpack-devserver" class="header-anchor">#</a> webpack devServer</h2> <div class="language- extra-class"><pre><code>webpack-dev-server --open
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    devServer<span class="token operator">:</span><span class="token punctuation">{</span>
        contentBase<span class="token operator">:</span> <span class="token string">'./public'</span><span class="token punctuation">,</span>
        proxy<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">'/api'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token comment">// http://localhost:8080/api/users -&gt; https://api.github.com/api/users</span>
                target<span class="token operator">:</span> <span class="token string">'https://api.github.com'</span><span class="token punctuation">,</span>
                <span class="token comment">// http://localhost:8080/api/users -&gt; https://api.github.com/users</span>
                pathRewrite<span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token string">'^/api'</span><span class="token operator">:</span> <span class="token string">''</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token comment">// 不能使用localhost:8080 作为请求GitHub的主机名</span>
                changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="source-map"><a href="#source-map" class="header-anchor">#</a> Source Map</h2> <ul><li>文件后缀 .map</li> <li>构建后代码最后一行注释 //# sourceMappingURL=jquery-3.4.1.min.map</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    devtool<span class="token operator">:</span> <span class="token string">'source-map'</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="devtool"><a href="#devtool" class="header-anchor">#</a> devtool</h2> <ul><li>开发环境下 cheap-module-eval-source-map</li> <li>生产环境 none ｜ nosources-source-map</li></ul> <h2 id="hmr-热替换"><a href="#hmr-热替换" class="header-anchor">#</a> HMR 热替换</h2> <div class="language- extra-class"><pre><code>webpack-dev-server --hot
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span>'webpack<span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
        hot<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugin<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>HotModuleReplacementPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>HMR apis</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token string">'./editor'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'editor 更新了'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="不同环境不同配置"><a href="#不同环境不同配置" class="header-anchor">#</a> 不同环境不同配置</h2> <ol><li>配置文件根据环境不同导出不同配置<div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">env<span class="token punctuation">,</span> argv</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>env <span class="token operator">===</span> 'production<span class="token punctuation">)</span><span class="token punctuation">{</span>
        
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li>一个环境对应一个配置文件
<ul><li>webpack.common.js</li> <li>webpack.dev.js</li> <li>webpack.prod.js</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> merge <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-merge'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>common<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    mode<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    plugin<span class="token operator">:</span> <span class="token punctuation">[</span>

    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li></ol> <h2 id="defineplugin"><a href="#defineplugin" class="header-anchor">#</a> DefinePlugin</h2> <ul><li>为代码注入全局成员 process.env.NODE_ENV</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token constant">API_BASE_URL</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token string">'https://api.example.com'</span><span class="token punctuation">)</span> <span class="token comment">// js代码片段</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="tree-shaking-未引用代码-dead-code"><a href="#tree-shaking-未引用代码-dead-code" class="header-anchor">#</a> Tree-shaking 未引用代码（dead code）</h2> <ul><li>必须是ES Module</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 负责标记 「枯树叶」</span>
        usedExports<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token comment">// 负责「摇掉」它们</span>
        minimize<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token comment">//合并模块函数 Scope Hoisting</span>
        concatenateModules<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="tree-shaking-babel"><a href="#tree-shaking-babel" class="header-anchor">#</a> Tree-shaking &amp; Babel</h2> <ul><li>Babel可能把ES Module -&gt; CommonJS 导致不生效</li></ul> <h2 id="sideeffects-副作用"><a href="#sideeffects-副作用" class="header-anchor">#</a> sideEffects 副作用</h2> <ul><li>一般用于npm包标记是否有副作用</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
        sideEffects<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// package.json</span>
sideEffects<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
</code></pre></div><h2 id="webpack-分割代码-code-splitting"><a href="#webpack-分割代码-code-splitting" class="header-anchor">#</a> webpack 分割代码 Code Splitting</h2> <ul><li>分包，按需加载</li></ul> <h2 id="webpack-多入口打包"><a href="#webpack-多入口打包" class="header-anchor">#</a> webpack 多入口打包</h2> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    enrty<span class="token operator">:</span> <span class="token punctuation">{</span>
        index<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
        album<span class="token operator">:</span> <span class="token string">'./src/album.js'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span><span class="token punctuation">{</span>
        filename<span class="token operator">:</span> <span class="token string">'[name].bundle.js'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="提前公共模块"><a href="#提前公共模块" class="header-anchor">#</a> 提前公共模块</h2> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
        splitChunks<span class="token operator">:</span> <span class="token punctuation">{</span>
            chunks<span class="token operator">:</span> <span class="token string">'all'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="动态导入"><a href="#动态导入" class="header-anchor">#</a> 动态导入</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="魔法注释"><a href="#魔法注释" class="header-anchor">#</a> 魔法注释</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/* webpackChunkName: 'pots' */</span>
</code></pre></div><h2 id="minicssextractplugin-提取css到单个文件-css文件超过150kb使用"><a href="#minicssextractplugin-提取css到单个文件-css文件超过150kb使用" class="header-anchor">#</a> MiniCssExtractPlugin 提取CSS到单个文件 css文件超过150KB使用</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="optimizecssassetswebpackplugin-压缩输出的css文件"><a href="#optimizecssassetswebpackplugin-压缩输出的css文件" class="header-anchor">#</a> OptimizeCssAssetsWebpackPlugin 压缩输出的CSS文件</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">OptimizeCssAssetsWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="输出文件名hash"><a href="#输出文件名hash" class="header-anchor">#</a> 输出文件名Hash</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
 filename<span class="token operator">:</span> <span class="token string">'[name]-[hash:8].bundle.js'</span><span class="token punctuation">,</span>
 filename<span class="token operator">:</span> <span class="token string">'[name]-[hash].bundle.js'</span><span class="token punctuation">,</span>
 filename<span class="token operator">:</span> <span class="token string">'[name]-[chunkhash].bundle.js'</span><span class="token punctuation">,</span>
 filename<span class="token operator">:</span> <span class="token string">'[name]-[contenthash].bundle.js'</span>
<span class="token punctuation">}</span>


</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.941e80e8.js" defer></script><script src="/blog/assets/js/2.e09c9691.js" defer></script><script src="/blog/assets/js/24.d686d1ac.js" defer></script>
  </body>
</html>
